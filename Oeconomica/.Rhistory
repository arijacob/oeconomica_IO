return(season)
}
df = df %>%
mutate(year = year(date), month = month(date)) %>%
mutate(season = season_func(month)) %>%
select(-month)
<<<<<<< HEAD
reg = lm(log(dominant_sales) ~ conduct_period +
factor(state) + log(temp) + log(milk_price) +
log(sugar_price) + log(eggs_price) + log(diesel_price) +
log(dominant_wage) + log(waffle_cone_price) + log(cpi_less_food_and_energy) +
log(unemployment_rate) + factor(year) + factor(season), data = df)
reg2 = lm(log(dominant_sales) ~ conduct_period +
factor(state) + log(temp) + log(milk_price) +
log(sugar_price) + log(eggs_price) + log(diesel_price) +
log(dominant_wage) + log(waffle_cone_price) + log(cpi_less_food_and_energy) +
log(unemployment_rate) + factor(year) + factor(season) + log(defendant_6_wage) + log(defendant_4_wage) + log(defendant_2_wage), data = df)
ggplot(df, aes(x = date)) +
geom_point(aes(y = defendant_1_price), color = "blue" , size = 0.25) +
geom_point(aes(y = defendant_2_price), color = "red", size = 0.25) +
geom_point(aes(y = defendant_3_price), color = "green", size = 0.25) +
geom_point(aes(y = defendant_4_price), color = "purple", size = 0.25) +
geom_point(aes(y = defendant_5_price), color = "darkblue", size = 0.25) +
geom_point(aes(y = defendant_6_price), color = "darkgreen", size =0.25) +
geom_point(aes(y = defendant_7_price), color = "orange", size =0.25) +
geom_point(aes(y = dominant_price), color = "black", size =0.25) +
labs(x = "Date", y = "Wages", title = "Defendant Prices Comparison") +
theme_minimal()
ggplot(df, aes(x = date)) +
geom_point(aes(y = defendant_1_price), color = "blue" , size = 0.25) +
geom_point(aes(y = defendant_2_price), color = "red", size = 0.25) +
geom_point(aes(y = defendant_3_price), color = "green", size = 0.25) +
geom_point(aes(y = defendant_4_price), color = "purple", size = 0.25) +
geom_point(aes(y = defendant_5_price), color = "darkblue", size = 0.25) +
geom_point(aes(y = defendant_6_price), color = "darkgreen", size =0.25) +
geom_point(aes(y = defendant_7_price), color = "orange", size =0.25) +
geom_point(aes(y = dominant_price), color = "black", size =0.25) +
labs(x = "Date", y = "Wages", title = "Defendant Prices Comparison") +
theme_minimal()
ggplot(df, aes(x = date)) +
geom_point(aes(y = defendant_1_price), color = "blue" , size = 0.25) +
geom_point(aes(y = defendant_2_price), color = "red", size = 0.25) +
geom_point(aes(y = defendant_3_price), color = "green", size = 0.25) +
geom_point(aes(y = defendant_4_price), color = "purple", size = 0.25) +
geom_point(aes(y = defendant_5_price), color = "darkblue", size = 0.25) +
geom_point(aes(y = defendant_6_price), color = "darkgreen", size =0.25) +
geom_point(aes(y = defendant_7_price), color = "orange", size =0.25) +
geom_point(aes(y = dominant_price), color = "black", size =0.25) +
labs(x = "Date", y = "Wages", title = "Defendant Prices Comparison") +
theme_minimal()
#wages graph
ggplot(df, aes(x = date)) +
geom_point(aes(y = rollmean(defendant_1_wage, k=15, align='right',  fill = NA)), color = "blue" , size = 0.25) +
geom_point(aes(y = defendant_2_wage), color = "red", size = 0.25) +
geom_point(aes(y = defendant_3_wage), color = "green", size = 0.25) +
geom_point(aes(y = defendant_4_wage), color = "purple", size = 0.25) +
geom_point(aes(y = defendant_5_wage), color = "darkblue", size = 0.25) +
geom_point(aes(y = defendant_6_wage), color = "darkgreen", size =0.25) +
#geom_point(aes(y = defendant_7_wage), color = "orange", size =0.25) +
geom_point(aes(y = dominant_price), color = "black", size =0.25) +
labs(x = "Date", y = "Wages", title = "Wages Comparison") +
theme_minimal()
#wages graph
ggplot(df, aes(x = date)) +
geom_line(aes(y = rollmean(defendant_1_wage, k=15, align='right',  fill = NA)), color = "blue" , size = 0.25) +
geom_point(aes(y = defendant_2_wage), color = "red", size = 0.25) +
geom_point(aes(y = defendant_3_wage), color = "green", size = 0.25) +
geom_point(aes(y = defendant_4_wage), color = "purple", size = 0.25) +
geom_point(aes(y = defendant_5_wage), color = "darkblue", size = 0.25) +
geom_point(aes(y = defendant_6_wage), color = "darkgreen", size =0.25) +
#geom_point(aes(y = defendant_7_wage), color = "orange", size =0.25) +
geom_point(aes(y = dominant_price), color = "black", size =0.25) +
labs(x = "Date", y = "Wages", title = "Wages Comparison") +
theme_minimal()
#wages graph
ggplot(df, aes(x = date)) +
geom_line(aes(y = rollmean(defendant_1_wage, k=15, align='right',  fill = NA)), color = "blue" , size = 0.25) +
geom_point(aes(y = defendant_2_wage), color = "red", size = 0.25) +
geom_line(aes(y = defendant_3_wage), color = "green", size = 0.25) +
geom_point(aes(y = defendant_4_wage), color = "purple", size = 0.25) +
geom_point(aes(y = defendant_5_wage), color = "darkblue", size = 0.25) +
geom_point(aes(y = defendant_6_wage), color = "darkgreen", size =0.25) +
#geom_point(aes(y = defendant_7_wage), color = "orange", size =0.25) +
geom_point(aes(y = dominant_price), color = "black", size =0.25) +
labs(x = "Date", y = "Wages", title = "Wages Comparison") +
theme_minimal()
#wages graph
ggplot(df, aes(x = date)) +
geom_line(aes(y = rollmean(defendant_1_wage, k=15, align='right',  fill = NA)), color = "blue" , size = 0.25) +
geom_point(aes(y = defendant_2_wage), color = "red", size = 0.25) +
geom_line(aes(y = defendant_3_wage), color = "green", size = 0.25) +
geom_point(aes(y = defendant_4_wage), color = "purple", size = 0.25) +
geom_point(aes(y = defendant_5_wage), color = "darkblue", size = 0.25) +
geom_point(aes(y = defendant_6_wage), color = "darkgreen", size =0.25) +
#geom_point(aes(y = defendant_7_wage), color = "orange", size =0.25) +
geom_point(aes(y = dominant_price), color = "black", size =0.25) +
labs(x = "Date", y = "Wages", title = "Wages Comparison") +
theme_minimal()
#wages graph
ggplot(df, aes(x = date)) +
geom_point(aes(y = rollmean(defendant_1_wage, k=15, align='right',  fill = NA)), color = "blue" , size = 0.25) +
geom_point(aes(y = defendant_2_wage), color = "red", size = 0.25) +
geom_point(aes(y = defendant_3_wage), color = "green", size = 0.25) +
geom_point(aes(y = defendant_4_wage), color = "purple", size = 0.25) +
geom_point(aes(y = defendant_5_wage), color = "darkblue", size = 0.25) +
geom_point(aes(y = defendant_6_wage), color = "darkgreen", size =0.25) +
#geom_point(aes(y = defendant_7_wage), color = "orange", size =0.25) +
geom_point(aes(y = dominant_price), color = "black", size =0.25) +
labs(x = "Date", y = "Wages", title = "Wages Comparison") +
theme_minimal()
#wages graph
ggplot(df, aes(x = date)) +
geom_point(aes(y = rollmean(defendant_1_wage, k=15, align='right',  fill = NA)), color = "black" , size = 0.25) +
geom_point(aes(y = defendant_2_wage), color = "red", size = 0.25) +
geom_point(aes(y = defendant_3_wage), color = "green", size = 0.25) +
geom_point(aes(y = defendant_4_wage), color = "purple", size = 0.25) +
geom_point(aes(y = defendant_5_wage), color = "darkblue", size = 0.25) +
geom_point(aes(y = defendant_6_wage), color = "darkgreen", size =0.25) +
#geom_point(aes(y = defendant_7_wage), color = "orange", size =0.25) +
geom_point(aes(y = dominant_price), color = "black", size =0.25) +
labs(x = "Date", y = "Wages", title = "Wages Comparison") +
theme_minimal()
#wages graph
ggplot(df, aes(x = date)) +
geom_point(aes(y = rollmean(defendant_1_wage, k=15, align='right',  fill = NA)), color = "black" , size = 0.25) +
geom_point(aes(y = defendant_2_wage), color = "red", size = 0.25) +
geom_point(aes(y = defendant_3_wage), color = "green", size = 0.25) +
geom_point(aes(y = defendant_4_wage), color = "purple", size = 0.25) +
geom_point(aes(y = defendant_5_wage), color = "darkblue", size = 0.25) +
geom_point(aes(y = defendant_6_wage), color = "darkgreen", size =0.25) +
#geom_point(aes(y = defendant_7_wage), color = "orange", size =0.25) +
#geom_point(aes(y = dominant_price), color = "black", size =0.25) +
labs(x = "Date", y = "Wages", title = "Wages Comparison") +
theme_minimal()
#wages graph
ggplot(df, aes(x = date)) +
geom_point(aes(y = rollmean(defendant_1_wage, k=15, align='right',  fill = NA)), color = "pink" , size = 0.25) +
geom_point(aes(y = defendant_2_wage), color = "red", size = 0.25) +
geom_point(aes(y = defendant_3_wage), color = "green", size = 0.25) +
geom_point(aes(y = defendant_4_wage), color = "purple", size = 0.25) +
geom_point(aes(y = defendant_5_wage), color = "darkblue", size = 0.25) +
geom_point(aes(y = defendant_6_wage), color = "darkgreen", size =0.25) +
#geom_point(aes(y = defendant_7_wage), color = "orange", size =0.25) +
#geom_point(aes(y = dominant_price), color = "black", size =0.25) +
labs(x = "Date", y = "Wages", title = "Wages Comparison") +
theme_minimal()
#wages graph
ggplot(df, aes(x = date)) +
geom_point(aes(y = defendant_1_wage), color = "pink" , size = 0.25) +
geom_point(aes(y = defendant_2_wage), color = "red", size = 0.25) +
geom_point(aes(y = defendant_3_wage), color = "green", size = 0.25) +
geom_point(aes(y = defendant_4_wage), color = "purple", size = 0.25) +
geom_point(aes(y = defendant_5_wage), color = "darkblue", size = 0.25) +
geom_point(aes(y = defendant_6_wage), color = "darkgreen", size =0.25) +
#geom_point(aes(y = defendant_7_wage), color = "orange", size =0.25) +
#geom_point(aes(y = dominant_price), color = "black", size =0.25) +
labs(x = "Date", y = "Wages", title = "Wages Comparison") +
theme_minimal()
reg2 = lm(log(dominant_sales) ~ conduct_period +
factor(state) + log(temp) + log(milk_price) +
log(sugar_price) + log(eggs_price) + log(diesel_price) +
log(dominant_wage) + log(waffle_cone_price) + log(cpi_less_food_and_energy) +
log(unemployment_rate) + factor(year) + factor(season) + log(defendant_6_wage) + log(defendant_4_wage), data = df)
summary(reg2)
reg2 = lm(log(dominant_sales) ~ conduct_period +
factor(state) + log(temp) + log(milk_price) +
log(sugar_price) + log(eggs_price) + log(diesel_price) +
log(dominant_wage) + log(waffle_cone_price) + log(cpi_less_food_and_energy) +
log(unemployment_rate) + factor(year) + factor(season) + log(defendant_6_wage) + log(defendant_4_wage) + log(defendant_5_wage), data = df)
summary(reg2)
#wages graph
ggplot(df, aes(x = date)) +
geom_point(aes(y = defendant_1_wage), color = "pink" , size = 0.25) +
geom_point(aes(y = defendant_2_wage), color = "red", size = 0.25) +
geom_point(aes(y = defendant_3_wage), color = "green", size = 0.25) +
geom_point(aes(y = defendant_4_wage), color = "purple", size = 0.25) +
geom_point(aes(y = defendant_5_wage), color = "darkblue", size = 0.25) +
geom_point(aes(y = defendant_6_wage), color = "darkgreen", size =0.25) +
#geom_point(aes(y = defendant_7_wage), color = "orange", size =0.25) +
#geom_point(aes(y = dominant_price), color = "black", size =0.25) +
labs(x = "Date", y = "Wages", title = "Wages Comparison") +
theme_minimal()
#wages graph
ggplot(df, aes(x = date)) +
geom_point(aes(y = defendant_1_wage), color = "pink" , size = 0.25) +
geom_point(aes(y = defendant_2_wage), color = "red", size = 0.25) +
geom_point(aes(y = defendant_3_wage), color = "green", size = 0.25) +
geom_point(aes(y = defendant_4_wage), color = "purple", size = 0.25) +
geom_point(aes(y = defendant_5_wage), color = "darkblue", size = 0.25) +
geom_point(aes(y = defendant_6_wage), color = "darkgreen", size =0.25) +
#geom_point(aes(y = defendant_7_wage), color = "orange", size =0.25) +
#geom_point(aes(y = dominant_price), color = "black", size =0.25) +
labs(x = "Date", y = "Wages", title = "Wages Comparison") +
theme_minimal()
View(df)
library(tidyverse)
library(ggplot2)
library(ggthemes)
library(zoo)
df <- read.csv('https://raw.githubusercontent.com/arijacob/oeconomica_IO/main/Oeconomica/Master-data.csv')
df = df %>%
mutate(date = as.Date(date))
season_func <- function(month) {
season <- ifelse(month %in% c(12, 1, 2), "winter",
ifelse(month %in% c(3, 4, 5), "spring",
ifelse(month %in% c(6, 7, 8), "summer", "fall")))
return(season)
}
df = df %>%
mutate(year = year(date), month = month(date)) %>%
mutate(season = season_func(month)) %>%
select(-month)
reg = lm(log(dominant_sales) ~ conduct_period +
factor(state) + log(temp) + log(milk_price) +
log(sugar_price) + log(eggs_price) + log(diesel_price) +
log(dominant_wage) + log(waffle_cone_price) + log(cpi_less_food_and_energy) +
log(unemployment_rate) + factor(year) + factor(season), data = df)
df_zero = df %>%
mutate(conduct_period = 0)
df = df %>%
mutate(predicted = predict(reg, newdata = df),
predicted_zero =  predict(reg, newdata = df_zero))
summary(reg)
reg2 = lm(log(dominant_sales) ~ conduct_period +
factor(state) + log(temp) + log(milk_price) +
log(sugar_price) + log(eggs_price) + log(diesel_price) +
log(dominant_wage) + log(waffle_cone_price) + log(cpi_less_food_and_energy) +
log(unemployment_rate) + factor(year) + factor(season) + log(defendant_6_wage) + log(defendant_4_wage) + log(defendant_5_wage), data = df)
summary(reg2)
reg2 = lm(log(dominant_sales) ~ conduct_period +
=======
reg3 = lm(log(dominant_sales) ~ conduct_period +
>>>>>>> 0d569b12bebc6f7b42930f928efb541dede72024
factor(state) + log(temp) + log(milk_price) +
log(sugar_price) + log(diesel_price) +
log(dominant_wage) + log(waffle_cone_price) + log(cpi_less_food_and_energy) +
log(unemployment_rate) + factor(year) + factor(season) + log(defendant_6_wage) + log(defendant_4_wage) + log(defendant_5_wage), data = df)
<<<<<<< HEAD
summary(reg2)
reg2 = lm(log(dominant_sales) ~ conduct_period +
factor(state) + log(temp) + log(milk_price) +
log(sugar_price) + log(diesel_price) +
log(dominant_wage) + log(waffle_cone_price) + log(cpi_less_food_and_energy) +
log(unemployment_rate) + factor(year) + factor(season) + log(defendant_6_wage) + log(defendant_4_wage) + log(defendant_5_wage), data = df)
summary(reg2)
reg2 = lm(log(dominant_sales) ~ conduct_period +
factor(state) + log(temp) + log(milk_price) +
log(sugar_price) + log(diesel_price) +
log(dominant_wage) + log(waffle_cone_price) + log(cpi_less_food_and_energy) +
log(unemployment_rate) + factor(year) + factor(season) + log(defendant_6_wage) + log(defendant_4_wage) + log(defendant_5_wage), data = df)
reg2 = lm(log(dominant_sales) ~ conduct_period +
factor(state) + log(temp) + log(milk_price) +
log(sugar_price) + log(diesel_price) +
log(dominant_wage) + log(waffle_cone_price) + log(cpi_less_food_and_energy) +
log(unemployment_rate) + factor(year) + factor(season) + log(defendant_6_wage) + log(defendant_4_wage) + log(defendant_5_wage), data = df)
#Comparing actual sales to average with rolling mean
ggplot(data = df, aes(x = date)) +
geom_line(aes(y = rollmean(log(dominant_sales), k=20, align='right',  fill = NA), color = "Actual Sales")) +  # actual sales logged
geom_line(aes(y = rollmean(predicted_zero, k=20, align='right',  fill = NA), color = "Predicted Sales assuming no misconduct")) + # Regression line with 'conduct_period' set to zero
scale_color_manual(values = c(
'Actual Sales' = 'darkgreen',
'Predicted Sales assuming no misconduct' = 'purple')) +
labs(y = "Sales (logged)", color = 'Legend') +
theme_excel_new()
ggplot(df, aes(x = date)) +
geom_point(aes(y = defendant_4_wage), color = "purple", size = 0.25) +
geom_point(aes(y = defendant_5_wage), color = "darkblue", size = 0.25) +
geom_point(aes(y = defendant_6_wage), color = "darkgreen", size =0.25) +
geom_point(aes(y = dominant_wage), color = "black", size =0.25) +
labs(x = "Date", y = "Wages", title = "Wages Comparison") +
theme_minimal()
ggplot(df, aes(x = date)) +
geom_point(aes(y = defendant_4_wage), color = 'Defendant 4 Wages', size = 0.25) +
geom_point(aes(y = defendant_5_wage), color = 'Defendant 5 Wages', size = 0.25) +
geom_point(aes(y = defendant_6_wage), color = 'Defendant 6 Wages', size =0.25) +
geom_point(aes(y = dominant_wage), color = 'Doms Wages', size =0.25) +
labs(x = "Date", y = "Wages", title = "Wages Comparison") +
scale_color_manual(values = c(
'Doms Wages' = 'black',
'Defendant 4 Wages' = 'purple',
'Defendant 5 Wages' = 'darkblue',
'Defendant 6 Wages' = 'darkgreen')) +
theme_excel_new()
ggplot(df, aes(x = date)) +
geom_point(aes(y = defendant_4_wage), color = 'Defendant 4 Wages', size = 0.25) +
geom_point(aes(y = defendant_5_wage), color = 'Defendant 5 Wages', size = 0.25) +
geom_point(aes(y = defendant_6_wage), color = 'Defendant 6 Wages', size =0.25) +
geom_point(aes(y = dominant_wage), color = 'Doms Wages', size =0.25) +
labs(x = "Date", y = "Wages", title = "Wages Comparison") +
scale_color_manual(values = c(
'Doms Wages' = 'black',
'Defendant 4 Wages' = 'purple',
'Defendant 5 Wages' = 'darkblue',
'Defendant 6 Wages' = 'darkgreen')) +
theme_excel_new()
ggplot(df, aes(x = date)) +
geom_point(aes(y = defendant_4_wage), color = "purple", size = 0.25) +
geom_point(aes(y = defendant_5_wage), color = "darkblue", size = 0.25) +
geom_point(aes(y = defendant_6_wage), color = "darkgreen", size =0.25) +
geom_point(aes(y = dominant_wage), color = "black", size =0.25) +
labs(x = "Date", y = "Wages", title = "Wages Comparison") +
theme_excel_new()
ggplot(df, aes(x = date)) +
geom_point(aes(y = defendant_4_wage, color = "Defendant 4"), size = 0.25) +
geom_point(aes(y = defendant_5_wage, color = "Defendant 5"), size = 0.25) +
geom_point(aes(y = defendant_6_wage, color = "Defendant 6"), size = 0.25) +
geom_point(aes(y = dominant_wage, color = "Dominant"), size = 0.25) +
labs(x = "Date", y = "Wages", title = "Wages Comparison") +
scale_color_manual(values = c("Defendant 4" = "purple",
"Defendant 5" = "darkblue",
"Defendant 6" = "darkgreen",
"Dominant" = "black")) +
theme_excel_new()
ggplot(df, aes(x = date)) +
geom_point(aes(y = defendant_4_wage, color = "Defendant 4"), size = 0.25) +
geom_point(aes(y = defendant_5_wage, color = "Defendant 5"), size = 0.25) +
geom_point(aes(y = defendant_6_wage, color = "Defendant 6"), size = 0.25) +
geom_point(aes(y = dominant_wage, color = "Dominant"), size = 0.25) +
labs(x = "Date", y = "Wages", title = "Wages Comparison") +
scale_color_manual(values = c("Defendant 4" = "purple",
"Defendant 5" = "blue",
"Defendant 6" = "green",
"Dominant" = "black")) +
theme_excel_new()
ggplot(df, aes(x = date)) +
geom_line(aes(y = defendant_4_wage, color = "Defendant 4"), size = 0.25) +
geom_line(aes(y = defendant_5_wage, color = "Defendant 5"), size = 0.25) +
geom_line(aes(y = defendant_6_wage, color = "Defendant 6"), size = 0.25) +
geom_line(aes(y = dominant_wage, color = "Dominant"), size = 0.25) +
labs(x = "Date", y = "Wages", title = "Wages Comparison") +
scale_color_manual(values = c("Defendant 4" = "purple",
"Defendant 5" = "blue",
"Defendant 6" = "green",
"Dominant" = "black")) +
theme_excel_new()
ggplot(df, aes(x = date)) +
geom_point(aes(y = defendant_4_wage, color = "Defendant 4"), size = 0.25) +
geom_point(aes(y = defendant_5_wage, color = "Defendant 5"), size = 0.25) +
geom_point(aes(y = defendant_6_wage, color = "Defendant 6"), size = 0.25) +
geom_point(aes(y = dominant_wage, color = "Dominant"), size = 0.25) +
labs(x = "Date", y = "Wages", title = "Wages Comparison") +
scale_color_manual(values = c("Defendant 4" = "purple",
"Defendant 5" = "blue",
"Defendant 6" = "green",
"Dominant" = "black")) +
theme_excel_new()
ggplot(df, aes(x = date)) +
geom_point(aes(y = defendant_4_wage, color = "Defendant 4"), size = 0.25) +
geom_point(aes(y = defendant_5_wage, color = "Defendant 5"), size = 0.25) +
geom_point(aes(y = defendant_6_wage, color = "Defendant 6"), size = 0.25) +
geom_point(aes(y = dominant_wage, color = "Dominant"), size = 0.25) +
labs(x = "Date", y = "Wages", title = "Wages Comparison") +
scale_color_manual(values = c("Defendant 4" = "purple",
"Defendant 5" = "blue",
"Defendant 6" = "green",
"Dominant" = "black")) +
theme_excel_new()
ggplot(df, aes(x = date)) +
geom_point(aes(y = defendant_4_wage, color = "Defendant 4"), size = 0.25) +
geom_point(aes(y = defendant_5_wage, color = "Defendant 5"), size = 0.25) +
geom_point(aes(y = defendant_6_wage, color = "Defendant 6"), size = 0.25) +
geom_point(aes(y = dominant_wage, color = "Dominant"), size = 0.25) +
labs(x = "Date", y = "Wages", title = "Wages Comparison") +
scale_color_manual(values = c("Defendant 4" = "purple",
"Defendant 5" = "blue",
"Defendant 6" = "green",
"Dominant" = "black")) +
theme_excel_new()
ggplot(df, aes(x = date)) +
geom_point(aes(y = defendant_4_wage, color = "Defendant 4"), size = 0.25) +
geom_point(aes(y = defendant_5_wage, color = "Defendant 5"), size = 0.25) +
geom_point(aes(y = defendant_6_wage, color = "Defendant 6"), size = 0.25) +
geom_point(aes(y = dominant_wage, color = "Dominant"), size = 0.25) +
labs(x = "Date", y = "Wages", title = "Wages Comparison") +
scale_color_manual(values = c("Defendant 4" = "purple",
"Defendant 5" = "blue",
"Defendant 6" = "green",
"Dominant" = "black")) +
theme_excel_new()
library(tidyverse)
library(ggplot2)
library(ggthemes)
library(zoo)
df <- read.csv('https://raw.githubusercontent.com/arijacob/oeconomica_IO/main/Oeconomica/Master-data.csv')
df = df %>%
mutate(date = as.Date(date))
season_func <- function(month) {
season <- ifelse(month %in% c(12, 1, 2), "winter",
ifelse(month %in% c(3, 4, 5), "spring",
ifelse(month %in% c(6, 7, 8), "summer", "fall")))
return(season)
}
df = df %>%
mutate(year = year(date), month = month(date)) %>%
mutate(season = season_func(month)) %>%
select(-month)
ggplot(df, aes(x = date)) +
geom_point(aes(y = defendant_4_wage, color = "Defendant 4"), size = 0.25) +
geom_point(aes(y = defendant_5_wage, color = "Defendant 5"), size = 0.25) +
geom_point(aes(y = defendant_6_wage, color = "Defendant 6"), size = 0.25) +
geom_point(aes(y = dominant_wage, color = "Dominant"), size = 0.25) +
labs(x = "Date", y = "Wages", title = "Wages Comparison") +
scale_color_manual(values = c("Defendant 4" = "purple",
"Defendant 5" = "blue",
"Defendant 6" = "green",
"Dominant" = "black")) +
theme_excel_new()
ggplot(df, aes(x = date)) +
geom_point(aes(y = defendant_4_wage, color = "Defendant 4"), size = 0.25) +
geom_point(aes(y = defendant_5_wage, color = "Defendant 5"), size = 0.25) +
geom_point(aes(y = defendant_6_wage, color = "Defendant 6"), size = 0.25) +
geom_point(aes(y = dominant_wage, color = "Dominant"), size = 0.25) +
labs(x = "Date", y = "Wages", title = "Wages Comparison") +
scale_color_manual(values = c("Defendant 4" = "purple",
"Defendant 5" = "blue",
"Defendant 6" = "green",
"Dominant" = "black")) +
theme_excel_new()
df = df %>%
mutate(predicted = predict(reg2, newdata = df),
predicted_zero =  predict(reg2, newdata = df_zero,),
predicted_other = predict(reg, newdata = df))
reg = lm(log(dominant_sales) ~ conduct_period +
factor(state) + log(temp) + log(milk_price) +
log(sugar_price) + log(eggs_price) + log(diesel_price) +
log(dominant_wage) + log(waffle_cone_price) + log(cpi_less_food_and_energy) +
log(unemployment_rate) + factor(year) + factor(season), data = df)
reg2 = lm(log(dominant_sales) ~ conduct_period +
factor(state) + log(temp) + log(milk_price) +
log(sugar_price) + log(eggs_price) + log(diesel_price) +
log(dominant_wage) + log(waffle_cone_price) + log(cpi_less_food_and_energy) +
log(unemployment_rate) + factor(year) + factor(season) + log(defendant_6_wage) + log(defendant_4_wage) + log(defendant_5_wage), data = df)
df_zero = df %>%
mutate(conduct_period = 0)
df = df %>%
mutate(predicted = predict(reg2, newdata = df),
predicted_zero =  predict(reg2, newdata = df_zero,),
predicted_other = predict(reg, newdata = df))
#Comparing actual sales to average with rolling mean
ggplot(data = df, aes(x = date)) +
geom_line(aes(y = rollmean(log(dominant_sales), k=20, align='right',  fill = NA), color = "Actual Sales")) +  # actual sales logged
geom_line(aes(y = rollmean(predicted_zero, k=20, align='right',  fill = NA), color = "Predicted Sales assuming no misconduct")) +
geom_line(aes(y = rollmean(predicted_other, k =20, align='right', fill = NA), color = "Predicted without Inclusion of the Wages"))# Regression line with 'conduct_period' set to zero
#Comparing actual sales to average with rolling mean
ggplot(data = df, aes(x = date)) +
geom_line(aes(y = rollmean(log(dominant_sales), k=20, align='right',  fill = NA), color = "Actual Sales")) +  # actual sales logged
geom_line(aes(y = rollmean(predicted_zero, k=20, align='right',  fill = NA), color = "Predicted Sales assuming no misconduct")) + # Regression line with 'conduct_period' set to zero
scale_color_manual(values = c(
'Actual Sales' = 'darkgreen',
'Predicted Sales assuming no misconduct' = 'purple')) +
labs(y = "Sales (logged)", color = 'Legend') +
theme_excel_new()
summary(reg2)
reg2 = lm(log(dominant_sales) ~ conduct_period +
factor(state) + log(temp) + log(milk_price) +
log(sugar_price) + log(eggs_price) + log(diesel_price) +
log(dominant_wage) + log(waffle_cone_price) + log(cpi_less_food_and_energy) +
log(unemployment_rate) + factor(year) + factor(season) + log(defendant_6_wage) + log(defendant_4_wage) + log(defendant_5_wage), data = df)
summary(reg2)
reg = lm(log(dominant_sales) ~ conduct_period +
factor(state) + log(temp) + log(milk_price) +
log(sugar_price) + log(eggs_price) + log(diesel_price) +
log(dominant_wage) + log(waffle_cone_price) + log(cpi_less_food_and_energy) +
log(unemployment_rate) + factor(year) + factor(season), data = df)
reg2 = lm(log(dominant_sales) ~ conduct_period +
factor(state) + log(temp) + log(milk_price) +
log(sugar_price) + log(eggs_price) + log(diesel_price) +
log(dominant_wage) + log(waffle_cone_price) + log(cpi_less_food_and_energy) +
log(unemployment_rate) + factor(year) + factor(season) + log(defendant_6_wage) + log(defendant_4_wage) + log(defendant_5_wage), data = df)
=======
summary(reg3)
>>>>>>> 0d569b12bebc6f7b42930f928efb541dede72024
reg2 = lm(log(dominant_sales) ~ conduct_period +
factor(state) + log(temp) + log(milk_price) + log(eggs_price) +
log(sugar_price) + log(diesel_price) +
log(dominant_wage) + log(waffle_cone_price) + log(cpi_less_food_and_energy) +
log(unemployment_rate) + factor(year) + factor(season) + log(defendant_6_wage) + log(defendant_4_wage) + log(defendant_5_wage), data = df)
<<<<<<< HEAD
df_zero = df %>%
mutate(conduct_period = 0)
df = df %>%
mutate(predicted = predict(reg2, newdata = df),
predicted_zero =  predict(reg2, newdata = df_zero))
=======
#regression table
reg_table <- stargazer(reg2, type='text', digits = 2, title = 'Regression Table', style = 'qje', out = 'reg_2.doc')
doc <- read_docx()
install.packages(officer)
install.packages("officer")
library(officer)
reg2 = lm(log(dominant_sales) ~ conduct_period +
factor(state) + log(temp) + log(milk_price) + log(eggs_price) +
log(sugar_price) + log(diesel_price) +
log(dominant_wage) + log(waffle_cone_price) + log(cpi_less_food_and_energy) +
log(unemployment_rate) + factor(year) + factor(season) + log(defendant_6_wage) + log(defendant_4_wage) + log(defendant_5_wage), data = df)
#regression table
reg_table <- stargazer(reg2, type='text', digits = 2, title = 'Regression Table', style = 'qje', out = 'reg_2.doc')
doc <- read_docx()
doc <- doc %>%
body_add(reg_table)
print(doc, target = 'reg_2.docx')
#regression table
reg_table <- stargazer(reg2, type='text', digits = 2, title = 'Regression Table', style = 'qje', out = 'filename.doc/html/latex')
reg2 = lm(log(dominant_sales) ~ conduct_period +
factor(state) + log(temp) + log(milk_price) + log(eggs_price) +
log(sugar_price) + log(diesel_price) +
log(dominant_wage) + log(waffle_cone_price) + log(cpi_less_food_and_energy) +
log(unemployment_rate) + factor(year) + factor(season) + log(defendant_6_wage) + log(defendant_4_wage) + log(defendant_5_wage), data = df)
summary(reg2)
#regression table
stargazer(reg2)
>>>>>>> 0d569b12bebc6f7b42930f928efb541dede72024
